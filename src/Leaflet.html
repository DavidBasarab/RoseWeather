<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
		<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

		<style type="text/css">
			#map{
				height:500px;
			}
		</style>
	</head>
	<body>
		<div id="map"></div>
		<script type="text/javascript">

            function getToken() {

                var key = 'aLwjHZjqBfFPHYGvnyOKAGEVwlfQEtBm';
                var secert = 'RVSXxPx6QeuDLsxn';

                console.log('Get Token');

                var hashedCredential = btoa(key + ':' + secert);

                console.log(hashedCredential);

                return $.ajax({
                    type: 'POST',
                    url: 'http://api.awhere.com/oauth/token',
                    grant_type: 'client_credentials',
                    contentType: 'application/x-www-form-urlencoded',
                    headers: {
                        'Authorization': 'Basic ' + hashedCredential
                    }
                });
            }

            getToken().done(function(result) {
                var accessToken = result.access_token;

                var map = L.map('map').setView([38.1079412,-104.9736208], 6);
                L.tileLayer('https://api.awhere.com/v2/imagery/weathermaps/base,cities,radar/tiles/{x},{y},{z}?token={accessToken}', {
                    maxZoom: 12,
                    accessToken: accessToken
                }).addTo(map);
			});


		</script>
	</body>
</html>